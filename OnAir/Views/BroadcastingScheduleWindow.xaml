<Window x:Class="OnAir.Views.BroadcastingScheduleWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:OnAir.Converters"
        Title="Управление расписанием" 
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <converters:BroadcastToStringConverter x:Key="BroadcastToStringConverter"/>
    </Window.Resources>
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBlock Text="Выберите дату:" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <DatePicker x:Name="ScheduleDatePicker" Width="160" Style="{x:Null}"
                        SelectedDateChanged="ScheduleDatePicker_SelectedDateChanged"
                        Panel.ZIndex="1"
                        IsTodayHighlighted="True"
                        FirstDayOfWeek="Monday"
                        TextBoxBase.TextChanged="ScheduleDatePicker_TextChanged"
                        LostFocus="ScheduleDatePicker_LostFocus"/>
            <TextBlock Text="Время начала:" VerticalAlignment="Center" Margin="20,0,10,0"/>
            <TextBox x:Name="StartTimeTextBox" 
                     Width="60" 
                     Text="07:00"
                     PreviewTextInput="StartTimeTextBox_PreviewTextInput"
                     LostFocus="StartTimeTextBox_LostFocus"
                     Padding="5,0"/>
        </StackPanel>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <DockPanel Grid.Column="0">
                <TextBlock DockPanel.Dock="Top" Text="Доступные элементы:" Margin="0,0,0,5" FontSize="14" FontWeight="Bold"/>
                <DataGrid x:Name="AvailableItemsListBox" 
                         AutoGenerateColumns="False"
                         AllowDrop="True"
                         Drop="AvailableItemsListBox_Drop"
                         DragEnter="AvailableItemsListBox_DragEnter"
                         MouseMove="AvailableItemsListBox_MouseMove">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Имя" Binding="{Binding Title}" Width="150" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Серия" Binding="{Binding Series}" Width="80" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Часть" Binding="{Binding Part}" Width="80" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Описание" Binding="{Binding Description}" Width="*" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Длительность" Binding="{Binding Duration, StringFormat='{}{0:hh\\:mm}'}" Width="100" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Заказчик" Binding="{Binding Customer}" Width="120" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Права" Binding="{Binding Rights}" Width="100" IsReadOnly="True"/>
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>

            <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="10,0">
                <Button x:Name="AddToScheduleButton" Content="→" Width="40" Height="40" Margin="0,0,0,10"
                        Click="AddToScheduleButton_Click"/>
                <Button x:Name="RemoveFromScheduleButton" Content="←" Width="40" Height="40"
                        Click="RemoveFromScheduleButton_Click"/>
            </StackPanel>

            <DockPanel Grid.Column="2">
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,5">
                    <TextBlock Text="Расписание на выбранный день:" VerticalAlignment="Center" FontSize="14" FontWeight="Bold"/>
                    <Button x:Name="MoveUpButton" Content="↑" Width="30" Height="30" Margin="10,0,0,0"
                            Click="MoveUp_Click"/>
                    <Button x:Name="MoveDownButton" Content="↓" Width="30" Height="30" Margin="5,0,0,0"
                            Click="MoveDown_Click"/>
                </StackPanel>
                <DataGrid x:Name="ScheduleListBox" 
                         AutoGenerateColumns="False"
                         AllowDrop="True"
                         Drop="ScheduleListBox_Drop"
                         DragEnter="ScheduleListBox_DragEnter"
                         MouseMove="ScheduleListBox_MouseMove">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Время" Binding="{Binding StartTime, StringFormat='{}{0:hh\\:mm}'}" Width="80" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Имя" Binding="{Binding Items[0].Title}" Width="150" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Серия" Binding="{Binding Items[0].Series}" Width="80" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Часть" Binding="{Binding Items[0].Part}" Width="80" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Описание" Binding="{Binding Items[0].Description}" Width="*" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Длительность" Binding="{Binding Items[0].Duration, StringFormat='{}{0:hh\\:mm}'}" Width="100" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Заказчик" Binding="{Binding Items[0].Customer}" Width="120" IsReadOnly="True"/>
                        <DataGridTextColumn Header="Права" Binding="{Binding Items[0].Rights}" Width="100" IsReadOnly="True"/>
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
        </Grid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,20,0,0">
            <Button x:Name="SaveScheduleButton" Content="Сохранить расписание" Height="40" Margin="20,0,0,0"
                    Click="SaveScheduleButton_Click"/>
        </StackPanel>
    </Grid>
</Window> 